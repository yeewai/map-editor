'use strict';

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.search = search;
exports.chooseOption = chooseOption;
exports.chooseOptionBySearching = chooseOptionBySearching;

var _reactSelect = require('react-select');

var _reactSelect2 = _interopRequireDefault(_reactSelect);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function findSelect(wrapper) {
  var plainSelect = wrapper.find(_reactSelect2.default);
  if (plainSelect.length > 0) {
    return plainSelect;
  }

  var asyncSelect = wrapper.find(_reactSelect2.default.Async);
  if (asyncSelect.length > 0) {
    return asyncSelect;
  }

  throw new Error("Couldn't find Select or Select.Async in wrapper");
}

function search(wrapper, queryString, callback) {
  findSelect(wrapper).find('.Select-input input').simulate('change', { target: { value: queryString } });
  setTimeout(callback, 0);
}

function chooseOption(wrapper, optionText) {
  var options = findSelect(wrapper).find('.Select-option');
  var matchingOptions = options.filterWhere(function (option) {
    return option.text() === optionText;
  });
  matchingOptions.simulate('mouseDown');
}

function chooseOptionBySearching(wrapper, queryString, optionText, callback) {
  search(wrapper, queryString, function () {
    chooseOption(wrapper, optionText);
    callback();
  });
}